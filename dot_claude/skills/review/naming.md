# Naming Review

kawasima氏の「命名のプロセス」に基づく進化的アプローチでコードの命名をレビューするスキル。

関連: @~/.claude/rules/robust-code.md（型による予防的設計、Value Object）

> 良い命名は単一ステップではなく**プロセス**である。
> 最初から完璧を目指すのではなく、段階的に改善していく。

命名は設計であり、コードの読みやすさに直結する。プログラマはプログラミング全体の60-70%をコードを読むことに費やしている。

---

## 7段階の命名進化

| 段階 | 名前 | 状態 |
|------|------|------|
| 1 | Missing | 抽象化すべき概念に名前がない |
| 2 | Nonsense | 意図的に無意味な名前（Applesauce等） |
| 3 | Honest | 主要な作用を反映した名前 |
| 4 | Honest and Complete | 全ての作用を表現 |
| 5 | Does the Right Thing | 単一責務に分割された状態 |
| 6 | Intent | なぜ必要かを示す名前 |
| 7 | Domain Abstraction | 統一されたドメイン概念 |

### Stage 1-2: Missing → Nonsense

名前のない概念を見つけ、まずは抽出する。

**長いものに注目**: 長いメソッド・クラス・ファイル、長い引数リスト、複雑な式
**塊を探す**: ひとまとまりの文、明確でない式、よく一緒に渡されるパラメータ

リファクタリング手法:
- **メソッド抽出** - 文の塊に名前を付ける
- **変数導入** - 式に名前を付ける
- **パラメータオブジェクト導入** - パラメータ集合に名前を付ける

### Stage 3: Nonsense → Honest

メソッドの中心となる1つの概念を理解し、実直な名前にする。コード内のパターン（システムコンポーネント変数、繰り返されるパターン、戻り値の使われ方）を探す。

**重要**: **何であるか**ではなく**何をするか**で命名する。

### Stage 4: Honest → Honest and Complete

メソッドがしている**すべて**を名前で表現する。名前が長くなるのは**設計の問題を示すシグナル**。次のステージで責務を分割する。

### Stage 5: Does the Right Thing

責務を分割し、単一責務の原則に従う。

1. 名前から排除したい部分を特定
2. その部分が他と無関係か確認
3. 構造的リファクタリングを実施

### Stage 6: Intent（意図）

**何をしているか**から**なぜ必要か**へ転換する。

見るべき対象:
- **メソッド**: 事後条件、実現される変換、ビジネスプロセス
- **クラス**: 共通責務、現実世界の対応物
- **変数**: 同じ型の他インスタンスとの違い

避けるべきパターン: 初期条件で命名、コンピュータ科学用語のみ使用、ドメイン文脈を欠いた命名。

### Stage 7: Domain Abstraction

共有コンテキストと統一されたドメイン概念を形成する。

探すべきパターン:
- **クラス群**: 類似の名前、Manager/Transform/~er で終わる名前、Feature Envy
- **メソッド群**: 一緒に渡される複数パラメータ、同じデータへの操作、類似の名前
- **フィールド/パラメータ**: 型名と同じ変数名、許容値や解釈が必要な名前

Value Object の導入で、プリミティブ型への執着を解消する。

---

## チェックリスト

- [ ] 名前のない概念が放置されていないか
- [ ] 誤解を招く名前はないか
- [ ] メソッド名は主要な作用を反映しているか
- [ ] 名前が長すぎる（責務が多すぎる）サインはないか
- [ ] 何をするかではなく、なぜ必要かを表現しているか
- [ ] ドメイン用語を適切に使用しているか
- [ ] プリミティブ型への執着はないか（Value Object化の検討）

---

## 実行フロー

### 1. 対象の特定

```
対象: $ARGUMENTS
```

引数がない場合はユーザーに確認。

### 2. コード読み取り

対象ファイル/ディレクトリの公開API（関数、クラス、メソッド）を特定。

### 3. 各識別子を7段階で評価

| 段階 | 名前 | 問題の兆候 |
|------|------|-----------|
| 1 | Missing | 抽出すべき概念が埋もれている |
| 2 | Nonsense | temp, data, info 等の汎用名 |
| 3 | Honest | 副作用が名前に反映されていない |
| 4 | Honest and Complete | 名前が長い（責務過多のサイン） |
| 5 | Does the Right Thing | 単一責務 |
| 6 | Intent | 目的を表現 |
| 7 | Domain Abstraction | ドメイン用語として統一 |

### 4. 問題パターンの検出

- 誤解を招く名前
- プリミティブ型への執着（Value Object化の候補）
- Manager/Handler/Processor 等の曖昧なサフィックス
- Feature Envy（他オブジェクトへの過度なアクセス）

### 5. 改善提案の出力

各問題について：
- 現在の段階
- 問題点
- 改善案（複数オプション提示）
- 推奨案と理由

### 6. サマリー出力

- 評価した識別子数と問題数
- 優先度高の改善項目
- ドメイン抽象化の候補

---

## リファレンス

レビュー時の詳細な判断基準と出力フォーマット例: @reference.md

## 注意事項

- レビューのみ。編集は行わない
- 大規模な変更は段階的実施を推奨
